## 斯特林数 Stirling

### 简介

斯特林数是组合数学中的一个重要内容，有许多有用的性质。
它由十八世纪的苏格兰数学家James Stirling首先发现并说明了它们的重要性。
斯特林数主要处理的是把N个不同的元素分成k个集合或环的个数问题。
现在我们说的斯特林数可以指两类数，分为第一类斯特林数和第二类斯特林数，其中第一类斯特林数还分成有符号和无符号两种。

### 第一类斯特林数

这里仅讨论有符号第一类斯特林数。  

第一类斯特林数表示的是将 $n​$ 个不同元素分成 $k​$ 个不同的环的方案数。

两个环不相同当且仅当这两个环不能通过旋转得到。表示方法为
$$
\left[
	\begin{matrix}
		n\\
		k\\
	\end{matrix}
\right]
$$
考虑递推，把 $n​$ 个不同元素分成 $k​$ 个不同的环有两种转移。第一种，有可能是 $n−1​$ 个不同元素分成 $k−1​$ 个不同的环，当前的第 $n​$ 个独立成一个元素。第二种可能是 $n−1​$ 个不同元素已经分好了 $k​$ 个不同的环，当前这个可以加进去。加在每个已有元素的逆时针方向（或顺时针方向，方向没有关系，只要统一即可）就不会出现重复，共有 $n−1​$ 种方法，所以:
$$
\left[
	\begin{matrix}
		0\\
		0\\
	\end{matrix}
\right]
=1\\
$$

$$
\left[
	\begin{matrix}
		n\\
		k\\
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
		n-1\\
		k-1\\
	\end{matrix}
\right]
+
\left[
	\begin{matrix}
		n-1\\
		k\\
	\end{matrix}
\right]
*
(n-1)
$$

这就是第一类斯特林数的递推式，也可以写成：
$$
s(n,k)=s(n-1,k-1)+s(n-1,k)*(n-1)
$$

#### 性质

第一类斯特林数有如下特殊性质：

1. $S(0,0) =1$
2. $S(n,0) = 0 \quad (n>0)$
3. $S(n,1) = (n-1)!$
4. $S(n,n-1)=C^2_n$
5. $S(n,2) = (n-1)!*\sum^{n-1}_{i=1} \frac{1}{i}$
6. $S(n,n-2)=2C^3_n+3C^4_n$
7. $\sum^n_{k=0}S(n,k) = n!$

#### 代码

递推式：
$$
dp[i][j]=dp[i-1][j-1]+dp[i-1][j]*(i-1)
$$

``` c++
dp[0][0] = 1;
for(int i = 1;i <= n; i++)
{
    for(int j = 1;j <= i; j++)
    {
        dp[i][j] = dp[i-1][j-1]+dp[i-1][j]*(i-1);
    }
} 
```

### 第二类斯特林数

第二类斯特林数表示把 $n​$ 个元素分成 $k​$ 个非空集合的方案数，集合内是无序的。这样，我们很容易得出转移：

分为两种情况。

- 第一种情况，如果前 $n−1​$ 个元素组成了 $k−1​$ 个非空集合，那么当前元素自成一个集合。

- 第二种情况，如果前 $n−1​$ 个元素组成了 $k​$ 个集合，那么当前的这个元素可以放进这 $k​$ 个集合中任意的一个。

所以我们得到递推方程:
$$
\left[
	\begin{matrix}
		n\\
		k\\
	\end{matrix}
\right]
=
\left[
	\begin{matrix}
		n-1\\
		k-1\\
	\end{matrix}
\right]
+
\left[
	\begin{matrix}
		n-1\\
		k\\
	\end{matrix}
\right]
*k
$$
也可以写成：
$$
S(n,k)=S(n-1,k-1)+S(n-1,k)*k
$$

#### 性质

1. $S(0,0) = 1$
2. $S(n,0)  = 0,\quad n>0$
3. $S(n,n) = 1$
4. $S(n,2) = S(n-1,1)+S(n-1,2)*2=1+S(n-1,2)*2=2^{n-1}-1​$
5. $S(n,n-1)=C^2_n$
6. $S(n,n-2)=C^3_n+3C^4_n$
7. $S(n,3)=\frac{1}{2}(3^{n-1}+1)-2^{n-1}$
8. $S(n,n-3)=C^4_n+10C^5_n+15C^5_n$

通项公式：
$$
S(n,m)=\frac{1}{m!}\sum^m_{j=1}(-1)^{m-j}C^j_mj^n
$$

#### 代码

递推式：
$$
dp[i][j]=dp[i-1][j-1]+dp[i-1][j]*j
$$

``` c++
dp[0][0] = 1;
for(int i = 1;i <= n; i++)
{
    for(int j = 1;j <= i; j++)
    {
        dp[i][j] = dp[i-1][j-1]+dp[i-1][j]*j;
    }
} 
```
